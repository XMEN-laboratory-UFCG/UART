.nf
.P Product Version     22.14    Cadence Design Systems, Inc. 
.fi
.TH addMetalFill  22.14 "Fri Oct 06 02:12:27 2023" 
.SH Name \fBaddMetalFill\fR \-  Inserts inactive metal into a placed and routed design to achieve the metal density within the range required by a specific manufacturing process
.SH Syntax \fBaddMetalFill\fR  [-help]   [-area <x1> <y1> <x2> <y2>]   [-extraCriticalNet <netNameList>]  [-excludeVia <via_list>]   [-ignoreLEFDensity]   [-iterationNameList {<list_of_iteration_names>}]   [-keepSquareFloating]   [-layer <layerName> | {<list_of_layer_names>}]   [-onCell [-std]]  [-pg_fill]  [-removeFloatingFill]   [-slackThreshold <slack>]   [-snap]   [-squareShape] | [-net {<netNameList>} [-genViaOnly] [-mesh | -meshOnly]]   [-stagger {on | off | diag}]   [-timingAware {on | off | sta}]   [-useNonDefaultSpacing] 
.P Inserts inactive metal into a placed and routed design to achieve the metal density within the range required by a specific manufacturing process. Avoids inserting metal on top of macros if it can achieve the preferred metal density without doing so. Use this command to insert metal fill after timing analysis and post route is complete.
.P addMetalFill provides complete support for Through Silicon Via (TSV) designs. You can insert tied-off metal fill in back side metal layers and add metal fill in iterations to back side layers.
.P During timing-driven metal fill, the software assigns costs to signal and clock nets so it can avoid placing metal fill near timing-critical nets.
.RS  "*" 2 It is recommended that you add metal fill after adding via fill. Alternatively, the via fill can also be added between floating metal fill.  "*" 2 If you use the -timingAware sta parameter, you must run timing analysis before adding metal fill. 
.RE
.P This command uses the values specified by the setMetalFill command. 
.P Some technologies use triangular shapes for Corner Stress Relief patterns. However, metal fill does not support triangular route blockages currently.
.P Note: This command does not support the 20nm and below node design rules. It is strongly recommended to use the PVS metal fill solution for 20nm and below nodes. The same solution should also be used for the sign-off metal fill rule deck of 28nm and above. 
.SH Adding Metal Fill in Multi-Threading Mode
.P You can add metal fill in multi-threading mode by using the following command before adding the metal fill:
.RS  "*" 2 setMultiCpuUsage
.RE
.P Metal Fill supports the new setMultiCpuUsage command use model. For more information, see the following documents:
.RS  "*" 2 setMultiCpuUsage chapter of the Innovus Text Command Reference.
.RE
.RS  "*" 2 Accelerating the Design Process by Using Multiple-CPU Processing chapter of the User Guide.
.RE 
.SH Parameters   "\fB-help\fR" Outputs a brief description that includes the type and default information for each addMetalFill parameter.  For a detailed description of the command and all its parameters, use the man command: man addMetalFill.  "\fB-area <x1 y1 x2 y2>\fR" Specifies a set of coordinates within which to add metal fill. This command reduces the fill area by half of the maximum design rule spacing defined in the LEF file. For example, if you specify -area 0 0 100 100, and the maximum spacing rule in the LEF file is 2.5 , addMetalFill adds fill in the following area: 1.25 1.25 98.75 98.75.  Default: If you do not specify this parameter, adds metal fill to the entire design area (taking the maximum spacing rule into account).
.SH Behavior of addMetalFill -area with external metal density   When metal fill is added to a block design the external metal density provides a density assumption to addMetalFill. The external density is used only for density calculation purposes and no fill shapes are added outside of the design area.  When the -area parameter is not specified, the external density value is not used. In this case, the addMetalFill window is pushed back if it extends outside the design area, as shown in the figure below.  (<Image> To view the image, refer to the Innovus Text Command Reference - Release 22.1 manual.)   (<Image> To view the image, refer to the Innovus Text Command Reference - Release 22.1 manual.)   If the -area parameter is specified and is larger than the design size then addMetalFill windows extend outside the block area and use the external density value (see setMetalFill for external density value specification) for that area.  If external density is less than the specified preferred density, it is more likely that shapes will be added to the area. If external density is greater than the preferred density it is less likely that shapes will be added (shapes are only added within the design boundary).  Note: Windows outside the design boundary are ignored.  "\fB-extraCriticalNet <netNameList>\fR" Specifies a list of extra critical nets for adding metal fill in the timing-aware mode. If you are using a third-party tool for sign-off static timing analysis (STA), your list of timing critical nets may be different from that generated by report_timing in Innovus/Tempus. In such a case, you can use -extraCriticalNet in one of the following ways:
.RS  "*" 2 In the -timingAware sta mode: The tool adds the extra nets you specify to the Innovus list of critical nets determined via the -slackThreshold method. If the list you specify is exactly the same as the Innovus list of critical nets, the tool works in the same way as it would without -extraCriticalNet.
.RE
.RS  "*" 2 In the -timingAware on mode: In this mode, the tool will consider the specified critical net list as medium cost. Use -extraCriticalNet in this mode if you want to avoid the runtime hit associated with performing timing analysis using the -timingAware sta option.
.RE   Note: If you use the -extraCriticalNet option in the -timingAware off mode, the tool waives the option and issues a warning message.  "\fB-excludeVia <via_list>\fR" Specifies vias or via rules to exclude from use by metal fill. Use this parameter to prevent the software from using the same vias inside MACROs and for metal fill insertion.  Separate the arguments with spaces. You can specify both via names and via rules.  
.RS  "*" 2 The following example shows how to specify a list of via names:  -excludeVia {VIA12 VIA23}
.RE
.RS  "*" 2 The following example shows how to specify a list of via rules:  -excludeVia {via1Array via2Array}
.RE
.RS  "*" 2 The following example shows how to specify both via names and via rules:  -excludeVia { VIA12 VIA23 via1Array via2Array}
.RE   "\fB-genViaOnly\fR" Specifies that only generated vias are used for metal fill connections.  Note: This parameter is enabled only when the -nets parameter is specified.  "\fB-ignoreLEFDensity\fR" Ignores the MACRO DENSITY table in the LEF file and instead uses the default macro density calculation method. For more information on the default macro density calculation method, refer to the "Estimating Density of Blockage" section in the Optimizing Metal Density chapter of the User Guide.  Note: If you do not specify this parameter, addMetalFill uses the LEF MACRO density table for density calculations.  "\fB-iterationNameList {<list_of_iteration_names>}\fR" Specifies a list of iterations (the names are specified by the setMetalFill -iterationName parameter) for adding metal fill. Processes the iterations in the order listed, and stops when the preferred density is reached in any iteration.  Running addMetalFill without the -iterationNameList parameter is the same as running the following command:  addMetalFill -iterationNameList default  If addMetalFill is looking for default, that is, if -iterationNameList default is specified or if you do not specify the -iterationNameList parameter, and the default settings are not defined by setMetalFill, the addMetalFill command uses it own internal default values, which are not derived from any setMetalFill -iterationName name.  When you run addMetalFill in iteration mode, it runs several times with just one invocation of the command, and uses the ending density from an iteration as the starting density of the next iteration. For that one invocation, the window size and step for a specific layer must be the same for all iterations.  Because addMetalFill uses preferred density to estimate the macro density, a different preferred density setting in iterationNameList will cause the different density estimation. The same preferred density setting in iterationNameList is recommended.  In the following example, addMetalFill fails because the specified values for -windowSize and -windowStep in step1, step2, and step3 are different:  setMetalFill -iterationName step1 -layer
... \\    -windowSize 100 100 -windowStep 50 50  setMetalFill -iterationName step2 -layer
... \\    -windowSize 100 100 -windowStep 50 50  setMetalFill -iterationName step3 -layer
... \\    -windowSize 50 50 -windowStep 25 25  addMetalFill -iterationNameList {step1 step2 step3}
...   If you run addMetalFill two times, and separate step3, (because its values are different from those of step1 and step2) the commands will succeed:  addMetalFill -iterationNameList {step1 step2}
...  addMetalFill -iterationNameList step3
...  "\fB-keepSquareFloating\fR" Specifies that unconnected (floating) metal fill must be square.  Default: If you do not specify this parameter, the software can create rectangular and square metal fill that is unconnected.  "\fB-layer <layerName> | {<list_of_layer_names>}\fR" Specifies the layers, including back side metal layers, on which the metal fill shapes will be created. If you specify more than one layer, separate each layer with a space and enclose the list in braces or double quotation marks. For example, to specify metal layers 1, 2, and 3, type one of the following commands:  addMetalFill -layer "METAL1 METAL2 METAL3"  addMetalFill -layer {METAL1 METAL2 METAL3}  Default: If you do not specify the -layer parameter, Innovus adds metal fill to all layers.  "\fB-mesh\fR" Connects metal fill shapes to the power mesh, allowing it to carry current as part of the power and ground structure. With mesh connections the software uses the maximum number of cuts in vias, based on the intersection area between layers, instead of the following the minimum-cut rule used with tree connections. Increasing the number of cuts helps to reduce IR drop.  Note: This parameter is enabled only when the -net parameter is specified.  The default values for the metal fill commands are optimized for timing, not power. For recommendations for values that are optimized for power, see "Recommendations for Power Strapping Mode" in the Optimizing Metal Density chapter of the User Guide.  "\fB-meshOnly\fR" Adds only multi-connection PG fill in the design. To improve IR drop, you may want to use tied-off metal fill to connect to power/ground (PG) nets. However, single-connection PG fill does not help in controlling IR drop. addMetalFill -meshOnly enables you to add only mesh or multi-connection fill and removes any single-connection PG fill. As a result, you can improve IR drop and reduce timing impact in the design.  With -meshOnly, the following PG fills are removed:  (<Image> To view the image, refer to the Innovus Text Command Reference - Release 22.1 manual.)   The following PG fills are retained with -meshOnly:  (<Image> To view the image, refer to the Innovus Text Command Reference - Release 22.1 manual.)   "\fB-net {<netNameList>}\fR" Specifies a list of special nets to which to connect metal fill. The nets must be listed in the SPECIALNETS section of the DEF file. PG nets that overlap with the fillwire are sorted by width and length. addMetalFill gives higher priority to the PG nets with greater dimensions (wider width and longer length), irrespective of their sequence in the netNameList.   Default: If you do not specify this parameter, metal fill is not connected to special nets (it is floating).  To specify nets VDD and VSS for connection, type the following command:  addMetalFill -net {VDD VSS}  Note: Do not specify this parameter if you also specify -squareShape as -net only applies rectangular shapes.  "\fB-onCell [-std]]\fR" Allows the software to add metal fill to CLASS BLOCK and CLASS PAD macro cells.  Before adding the metal fill, make sure that the cells are at the preferred density, because adding metal fill shapes inside the cells might lead to timing problems inside the cells.  If there are PIN/OBS in a cell, metal fill should be added on cells in layers with -oncell option. The density of macro will be estimated according to OBS/PIN area. If there are no PIN/OBS in a cell, metal fill should be added on cells in layers without -oncell option.  Note: The software can always add metal fill to CLASS CORE SPACER cells, but can add it to CLASS BLOCK and CLASS PAD cells only when this parameter is specified.  -std  Specify the -std parameter as well if you want to add metal fill only to standard cells.  "\fB-pg_fill\fR" Enables the use of power/ground fill flow.   "\fB-removeFloatingFill\fR" Removes unconnected metal fill from the design. When the software adds metal fill, it creates both connected and unconnected fill. When you specify -removeFloatingFill, it removes all the unconnected fill and leaves only metal fill that is connected.   Default: If you do not specify this parameter, the software leaves floating metal fill in the design.  "\fB-slackThreshold <slack>\fR" Specifies a slack threshold, in nanoseconds, for critical nets during timing-driven metal fill when you specify -timingAware sta. All nets with slack less than the -slackThreshold are considered critical.  For most designs, Cadence recommends you specify a small positive value for the slack threshold, such as 100 picoseconds, which gives you a small safety margin, as in the following command:  addMetalFill -slackThreshold 0.1  Default: 0.0  "\fB-snap\fR" Snaps edges of metal fill shapes and centers of cuts to a user- defined snap grid that is a multiple of the manufacturing grid. When the shapes are snapped to this grid, the edges of the shapes lie on the manufacturing grid. If the shapes are enclosed by on-Mgrid shapes, the shapes will ignore manufacturing grid check.  Other Innovus features share the grid, including verify, power planning and routing, and wire editing. Define the grid using the setSnapGrid command. If setSnapGrid is not specified, the software snaps the shapes to the manufacturing grid.  For more information, see setSnapGrid.  Note: When you specify this parameter, the software assumes that vias from the LEF file meet the snap grid requirements.  "\fB-squareShape\fR" Specifies that only square-shaped metal fill is added.   Default: If you do not specify this parameter, both rectangular and square metal fill can be added.  Note: Do not specify this parameter if you use the -net parameter as -net applies only to rectangular shapes.  "\fB-stagger {on | off | diag}\fR" Specifies the pattern for adding metal fill.   Default: on  Specify one of the following parameters:
.RS  "*" 2 on: Adds metal fill shapes in a staggered pattern in the preferred routing direction and in an aligned pattern in the non-preferred direction.
.RE
.RS  "*" 2 off: Adds metal fill shapes that line up in both the preferred and non-preferred routing directions, so that metal fill is not staggered.
.RE
.RS  "*" 2 diag: Adds metal fill shapes in a staggered pattern in both the preferred and non-preferred directions. Specify the offset for staggering with the following command:   setMetalFill -diagOffset <x y>  For example:  setMetalFill -diagOffset 0.05 0.05 
.RE   addMetalFill -stagger parameters  (<Image> To view the image, refer to the Innovus Text Command Reference - Release 22.1 manual.)   "\fB-std\fR" Adds metal fill to standard cells only.   Note: The -std parameter can be used only when the -oncell parameter is used.  "\fB-timingAware {on | off | sta}\fR" Specifies whether the software considers the timing impact of adding metal fill.  Default: on  Specify one of the following parameters:
.RS  "*" 2 off: Does not consider timing.
.RE
.RS  "*" 2 on: Assigns timing costs to nets and adds metal fill to nets with the lowest timing cost first. Adds less metal fill near clock and signal routing.   Divides nets into categories based on timing cost. The categories are:
.RE
.RS  "*" 2 Clock nets (highest cost)  "*" 2 Signal nets (moderate cost)  "*" 2 Power and ground nets--nets marked + USE POWER or + USE GROUND in the DEF file (0 cost)  "*" 2 sta: Runs in timing-aware mode using the Innovus common timing engine (CTE) for static timing analysis (STA). To benefit from using the sta parameter, you must have run timing analysis with the report_timing command prior to adding metal fill. If there are no timing structures in memory, the sta parameter behaves like the on parameter.   The sta parameter also divides nets into categories, but it uses the timing analysis results for assigning timing costs to nets. It adjusts the costs as a function of the slack (the worst slack has the highest cost) and uses the slackThreshold to separate critical and noncritical signal nets. Critical nets are signal nets with slack less than the threshold, and therefore have a higher cost than noncritical nets.   The categories are:
.RE
.RS
.RS  "*" 2 Clock nets (highest cost)
.RE 
.RE
.RS
.RS  "*" 2 Critical signal nets (moderate cost)
.RE 
.RE
.RS
.RS  "*" 2 Non-critical signal nets (small cost)
.RE 
.RE
.RS
.RS  "*" 2 Power and ground nets--marked + USE POWER or + USE GROUND in the DEF file (0 cost)
.RE 
.RE    Note: Specify a value for -slackThreshold if you specify sta.   "\fB-useNonDefaultSpacing\fR" Uses nondefault spacing for adding metal fill. Some critical nets use a nondefault rule (NDR) for routing as they may need to have wider wires or wider spacing than other nets. Use the -useNonDefaultSpacing option to extend NDR control to addMetalFill. 
.SH Example
.RS  "*" 2 The following command adds connected metal fill to the specified area on METAL1, METAL2, and METAL3, using the values set by the setMetalFill command:   addMetalFill -layer {METAL1 METAL2 METAL3} -area 100 200 300 400 -nets {VDD GND}  Here's a sample output from the software:  (<Image> To view the image, refer to the Innovus Text Command Reference - Release 22.1 manual.) 
.RE
.RS  "*" 2 The following set of commands:
.RE
.RS
.RS  "*" 2 Creates a nondefault rule testndr that sets the spacing of all layers to 0.8 micrometers.
.RE 
.RE
.RS
.RS  "*" 2 Sets the nondefault rule testndr for the clk net.
.RE 
.RE
.RS
.RS  "*" 2 Specifies that the router should strictly honor nondefault spacing.
.RE 
.RE
.RS
.RS  "*" 2 Adds metal fill using nondefault spacing
.RE 
.RE
.RS
.RS  "*" 2 Checks the nondefault rule spacing values for every route of the net clk.   initNdr   setNdrSpacing 0.8   createNdr testndr   setAttribute -net clk -non_default_rule testndr   setNanoRouteMode -route_strict_honor_route_rule true   addMetalFill -useNonDefaultSpacing 
.RE 
.RE
.RS  "*" 2 The following command inserts PG fill in back side layers B1 and B2:   addMetalFill -net {VDD VSS} -layer {B1 B2}
.RE
.RS  "*" 2 The following command saves run time by adding metal fill in iterations to back side layers B1 and B2.   addMetalFill -iterationNameList {iter1 iter2} -layer {B1 B2}
.RE
.RS  "*" 2 The following set of commands inserts metal fill in three iterations-step1, step2, and stepopc-to layers 1 to 8 in timing-aware mode:   restoreDesign  timeDesign -postRoute -outDir prefill  setMetalFill -layer {1 2 3 4 5 6 7 8} -iterationName step1 /               -gapSpacing 0.140 -minWidth 1 -decrement 0.050 /               -minLength 2 -maxWidth 5 -maxLength 20 -activeSpacing 0.8 /               -windowSize 50 50 -windowStep 25 25 -minDensity 15 /               -maxDensity 80 -preferredDensity 35 -diagOffset 1 1  setMetalFill -layer {1 2 3 4 5 6 7 8} -iterationName step2 /               -gapSpacing 0.140 -minWidth 0.140 -decrement 0.010 /               -minLength 0.14 -maxWidth 1 -maxLength 10 -activeSpacing 0.2 /               -windowSize 50 50 -windowStep 25 25 -minDensity 15 /               -maxDensity 80 -preferredDensity 25 -diagOffset 0.2 0.2   setMetalFill -layer {1 2 3 4 5 6 7 8} -iterationName stepopc -opc /               -gapSpacing 0.07 -minWidth 0.07 -decrement 0.010 /               -minLength 0.07 -maxWidth 1 -maxLength 10 -activeSpacing 0.07 /               -opcActiveSpacing 0.1 -windowSize 50 50 -windowStep 25 25 /               -minDensity 15 -maxDensity 80 -preferredDensity 25  addMetalFill -layer {1 2 3 4 5 6 7 8} /               -iterationNameList {step1 step2 stepopc} /               -timingAware sta
.RE 
.SH Related Information
.P "Adding Metal Fill Over Macros" section of the Optimizing Metal Density chapter of User Guide
.P
